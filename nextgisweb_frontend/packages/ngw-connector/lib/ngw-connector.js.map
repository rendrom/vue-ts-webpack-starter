{"version":3,"file":"ngw-connector.js","sources":["../src/polyfills.js","../src/ngw-connector.ts"],"sourcesContent":["Object.assign || Object.defineProperty(Object, 'assign', { enumerable: !1, configurable: !0, writable: !0, value: function (e, r) { 'use strict'; if (null == e) throw new TypeError('Cannot convert first argument to object'); for (let t = Object(e), n = 1; n < arguments.length; n++) { let o = arguments[n]; if (null != o) for (let a = Object.keys(Object(o)), c = 0, b = a.length; c < b; c++) { let i = a[c], l = Object.getOwnPropertyDescriptor(o, i); void 0 !== l && l.enumerable && (t[i] = o[i]) } } return t } });\r\n\r\n// https://github.com/taylorhakes/promise-polyfill\r\n// Copyright (c) 2014 Taylor Hakes\r\n// Copyright (c) 2014 Forbes Lindesay\r\n\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n!function(e,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?n():\"function\"==typeof define&&define.amd?define(n):n()}(0,function(){\"use strict\";function e(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){return n.reject(t)})})}function n(){}function t(e){if(!(this instanceof t))throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!=typeof e)throw new TypeError(\"not a function\");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],u(e,this)}function o(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,t._immediateFn(function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var o;try{o=t(e._value)}catch(f){return void i(n.promise,f)}r(n.promise,o)}else(1===e._state?r:i)(n.promise,e._value)})):e._deferreds.push(n)}function r(e,n){try{if(n===e)throw new TypeError(\"A promise cannot be resolved with itself.\");if(n&&(\"object\"==typeof n||\"function\"==typeof n)){var o=n.then;if(n instanceof t)return e._state=3,e._value=n,void f(e);if(\"function\"==typeof o)return void u(function(e,n){return function(){e.apply(n,arguments)}}(o,n),e)}e._state=1,e._value=n,f(e)}catch(r){i(e,r)}}function i(e,n){e._state=2,e._value=n,f(e)}function f(e){2===e._state&&0===e._deferreds.length&&t._immediateFn(function(){e._handled||t._unhandledRejectionFn(e._value)});for(var n=0,r=e._deferreds.length;r>n;n++)o(e,e._deferreds[n]);e._deferreds=null}function u(e,n){var t=!1;try{e(function(e){t||(t=!0,r(n,e))},function(e){t||(t=!0,i(n,e))})}catch(o){if(t)return;t=!0,i(n,o)}}var c=setTimeout;t.prototype[\"catch\"]=function(e){return this.then(null,e)},t.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new function(e,n,t){this.onFulfilled=\"function\"==typeof e?e:null,this.onRejected=\"function\"==typeof n?n:null,this.promise=t}(e,t,r)),r},t.prototype[\"finally\"]=e,t.all=function(e){return new t(function(n,t){function o(e,f){try{if(f&&(\"object\"==typeof f||\"function\"==typeof f)){var u=f.then;if(\"function\"==typeof u)return void u.call(f,function(n){o(e,n)},t)}r[e]=f,0==--i&&n(r)}catch(c){t(c)}}if(!e||\"undefined\"==typeof e.length)throw new TypeError(\"Promise.all accepts an array\");var r=Array.prototype.slice.call(e);if(0===r.length)return n([]);for(var i=r.length,f=0;r.length>f;f++)o(f,r[f])})},t.resolve=function(e){return e&&\"object\"==typeof e&&e.constructor===t?e:new t(function(n){n(e)})},t.reject=function(e){return new t(function(n,t){t(e)})},t.race=function(e){return new t(function(n,t){for(var o=0,r=e.length;r>o;o++)e[o].then(n,t)})},t._immediateFn=\"function\"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){c(e,0)},t._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn(\"Possible Unhandled Promise Rejection:\",e)};var l=function(){if(\"undefined\"!=typeof self)return self;if(\"undefined\"!=typeof window)return window;if(\"undefined\"!=typeof global)return global;throw Error(\"unable to locate global object\")}();\"Promise\"in l?l.Promise.prototype[\"finally\"]||(l.Promise.prototype[\"finally\"]=e):l.Promise=t});\r\n","\nimport './polyfills';\n\nimport { RequestItemsParamsMap } from './types/RequestItemsParamsMap';\nimport {\n  NgwConnectorOptions, Router,\n  RequestItemsResponseMap, RequestOptions,\n  Params, LoadingQueue, UserInfo,\n} from './interfaces';\n\nexport * from './interfaces';\n\nconst OPTIONS: NgwConnectorOptions = {\n  route: '/api/component/pyramid/route',\n  // baseUrl: 'http://'\n};\n\nexport class NgwConnector {\n\n  options: NgwConnectorOptions = {};\n\n  private route;\n  private _loadingQueue: { [name: string]: LoadingQueue } = {};\n  private _loadingStatus = {};\n\n  constructor(options: NgwConnectorOptions) {\n    this.options = Object.assign({}, OPTIONS, options || {});\n  }\n\n  async connect(): Promise<Router> {\n    if (this.route) {\n      return Promise.resolve(this.route);\n    } else {\n      if (this.options.auth) {\n        console.log(1234);\n        const { login, password } = this.options.auth;\n        if (login && password) {\n          await this.getUserInfo();\n        }\n      }\n      return await this.makeQuery(this.options.route, {}, {}).then((route) => {\n        this.route = route;\n        return route;\n      });\n    }\n  }\n\n  getUserInfo(): Promise<any> {\n    const client = this.makeClientId();\n    // return this.request('auth.current_user', {}, {\n    // return this.makeQuery('/api/component/auth/current_user', {}, {\n    //   headers: {\n    //     'Authorization': 'Basic ' + client,\n    //     'Access-Control-Allow-Origin': '*',\n    //     'Access-Control-Allow-Headers': '*',\n    //   },\n    //   withCredentials: true,\n    //   mode: 'cors',\n    // }).then((data: UserInfo) => {\n    //   console.log(data);\n    //   if (data.keyname !== 'guest') {\n    //     data.clientId = this.makeClientId();\n    //     if (localStorage) {\n    //       localStorage.setItem('nguser', JSON.stringify(data));\n    //     }\n    //   }\n    // });\n    return fetch(this.options.baseUrl + '/api/component/auth/current_user', {\n      headers: {\n        Authorization: 'Basic ' + client,\n        // 'Access-Control-Allow-Origin': '*',\n        // 'Access-Control-Allow-Headers': '*',\n      },\n      mode: 'cors',\n    }).then((resp) => {\n      console.log(resp);\n      resp.json().then((data) => {\n        if (data.keyname !== 'guest') {\n          data.clientId = this.makeClientId();\n          if (localStorage) {\n            localStorage.setItem('nguser', JSON.stringify(data));\n          }\n        }\n      });\n    });\n  }\n\n  makeClientId() {\n    const { login, password } = this.options.auth;\n    return window.btoa(unescape(encodeURIComponent(`${login}:${password}`)));\n  }\n\n  request<K extends keyof RequestItemsParamsMap>(\n    name: K,\n    params?: RequestItemsParamsMap[K] | {},\n    options?: RequestOptions): Promise<RequestItemsResponseMap[K]> {\n\n    return this.connect().then((apiItems) => {\n      for (const a in apiItems) {\n        if (apiItems.hasOwnProperty(a)) {\n          if (a === name) {\n            const apiItem = apiItems[a].slice();\n            let url = apiItem.shift();\n            if (apiItem.length) {\n              params = params || {};\n              const replaceParams = {};\n              for (let fry = 0; fry < apiItem.length; fry++) {\n                const arg = apiItem[fry];\n                replaceParams[fry] = '{' + arg + '}';\n                if (params[arg] === undefined) {\n                  throw new Error('`' + arg + '`' + ' url api argument is not specified');\n                }\n              }\n              url = template(url, replaceParams);\n            }\n            return this.makeQuery(url, params, options);\n          }\n        }\n      }\n    });\n  }\n\n  post<K extends keyof RequestItemsParamsMap>(\n    name: K,\n    options?: RequestOptions,\n    params?: RequestItemsParamsMap[K] | {}): Promise<RequestItemsResponseMap[K]> {\n\n    options = options || {};\n    options.method = 'POST';\n    return this.request(name, params, options);\n  }\n\n  makeQuery(\n    url: string,\n    params: Params,\n    options: RequestOptions): Promise<any> {\n\n    url = (this.options.baseUrl ? this.options.baseUrl : '') + url;\n    if (url) {\n      if (params) {\n        url = template(url, params);\n      }\n      // remove double slash\n      url = url.replace(/([^:]\\/)\\/+/g, '$1');\n      if (!this._loadingStatus[url]) {\n        this._loadingStatus[url] = true;\n\n        return this._getJson(url, options).then((data) => {\n          this._loadingStatus[url] = false;\n          this._exequteLoadingQueue(url, data);\n          return data;\n        }).catch((er) => {\n          this._loadingStatus[url] = false;\n          this._exequteLoadingQueue(url, er, true);\n        });\n      } else {\n        this._loadingStatus[url] = false;\n        const promise = new Promise((resolve, reject) => {\n          this._setLoadingQueue(url, resolve, reject);\n        });\n        return promise;\n      }\n    } else {\n      throw new Error('No `url` parameter set for option ' + name);\n    }\n\n  }\n\n  _setLoadingQueue(name, resolve, reject) {\n    this._loadingQueue[name] = this._loadingQueue[name] || {\n      name,\n      waiting: [],\n    };\n    this._loadingQueue[name].waiting.push({\n      resolve,\n      reject,\n      timestamp: new Date(),\n    });\n  }\n\n  _exequteLoadingQueue(name, data, isError?) {\n    const queue = this._loadingQueue[name];\n    if (queue) {\n      for (let fry = 0; fry < queue.waiting.length; fry++) {\n        const wait = queue.waiting[fry];\n        if (isError) {\n          if (wait.reject) {\n            wait.reject();\n          }\n        } else {\n          wait.resolve(data);\n        }\n      }\n      queue.waiting = [];\n    }\n  }\n\n  _getJson(url: string, options: RequestOptions): Promise<any> {\n    return new Promise((resolve, reject) => {\n      loadJSON(url, resolve, options, reject);\n    });\n  }\n}\n\nfunction loadJSON(url, callback, options: RequestOptions = {}, error) {\n  options.method = options.method || 'GET';\n  let xmlHttp: XMLHttpRequest;\n  if (options.mode === 'cors') {\n    xmlHttp = createCORSRequest(options.method, url);\n  } else {\n    xmlHttp = new XMLHttpRequest();\n    xmlHttp.open(options.method || 'GET', url, true); // true for asynchronous\n  }\n  xmlHttp.onreadystatechange = () => {\n    if (xmlHttp.readyState === 4 && xmlHttp.status === 200) {\n      if (xmlHttp.responseText) {\n        try {\n          callback(JSON.parse(xmlHttp.responseText));\n        } catch (er) {\n          error(er);\n        }\n      }\n    }\n  };\n\n  const headers = options.headers;\n  if (headers) {\n    for (const h in headers) {\n      if (headers.hasOwnProperty(h)) {\n        xmlHttp.setRequestHeader(h, headers[h]);\n      }\n    }\n  }\n  xmlHttp.withCredentials = options.withCredentials;\n  xmlHttp.send(options.data ? JSON.stringify(options.data) : null);\n}\n\nfunction createCORSRequest(method, url) {\n  let xhr = new XMLHttpRequest();\n  if ('withCredentials' in xhr) {\n    // Check if the XMLHttpRequest object has a \"withCredentials\" property.\n    // \"withCredentials\" only exists on XMLHTTPRequest2 objects.\n    xhr.open(method, url, true);\n  } else {\n    // @ts-ignore\n    const X = XDomainRequest;\n    if (typeof X !== 'undefined') {\n      // Otherwise, check if XDomainRequest.\n      // XDomainRequest only exists in IE, and is IE's way of making CORS requests.\n      xhr = new X();\n      xhr.open(method, url);\n    } else {\n      // Otherwise, CORS is not supported by the browser.\n      xhr = null;\n    }\n  }\n  return xhr;\n}\n\n// https://github.com/Leaflet/Leaflet/blob/b507e21c510b53cd704fb8d3f89bb46ea925c8eb/src/core/Util.js#L165\nconst templateRe = /\\{ *([\\w_-]+) *\\}/g;\n\nfunction template(str, data) {\n  return str.replace(templateRe, (s, key) => {\n    let value = data[key];\n\n    if (value === undefined) {\n      throw new Error('No value provided for letiable ' + s);\n\n    } else if (typeof value === 'function') {\n      value = value(data);\n    }\n    return value;\n  });\n}\n"],"names":["global"],"mappings":"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"}